# Zustand Stores

Client-side state management using Zustand. No providers needed - import and use directly.

## Barrel Export (Recommended)

Use the barrel export for clean imports:

```typescript
// Import everything from @/stores
import {
  useExerciseStore,
  useSessionStore,
  useVoiceStore,
  selectRepCount,
  selectIsConnected,
} from '@/stores';
```

## Stores

| Store | Purpose | Key State |
|-------|---------|-----------|
| `exercise-store.ts` | Current exercise being performed | exerciseId, repCount, formScore, phase, errors |
| `session-store.ts` | Workout session lifecycle | sessionId, startedAt, totalReps, exerciseHistory |
| `voice-store.ts` | Vapi connection & transcripts | connectionState, speakingStatus, transcript |
| `onboarding-store.ts` | Patient onboarding wizard | currentStep, assessmentDraft, permissions |
| `pt-store.ts` | PT dashboard state | selectedClient, planDraft |
| `message-store.ts` | PT-patient messaging | conversations, unreadCount |

## Session Hooks

Related hooks for workout session management (in `@/hooks`):

| Hook | Purpose |
|------|---------|
| `useSessionResume` | Crash recovery - check for persisted session, resume or discard |
| `useMultiTabGuard` | Multi-tab blocking - prevents concurrent workouts |
| `useAutoSave` | Auto-persist session state on interval and state changes |

```typescript
// Crash recovery example
const { hasRecoverableSession, resumeSession, discardSession } = useSessionResume();

// Multi-tab blocking example
const { hasConflict, claim, release } = useMultiTabGuard();
```

## Patterns

```typescript
// Import and use directly (no provider)
import { useExerciseStore } from '@/stores/exercise-store';

// In component
const { repCount, addRep } = useExerciseStore();

// With selector for performance
import { selectPhase } from '@/stores';
const phase = useExerciseStore(selectPhase);
```

## Conventions

- Each store has its own `*-selectors.ts` file for derived state
- State interfaces defined in the store file (not in `@/types`)
- DevTools enabled in development mode
- Persistence via `zustand/middleware` where needed (e.g., onboarding draft)

## Shared Types vs Store Types

- **Shared types** (`@/types`): Data structures passed between modules (FormError, SessionMetrics)
- **Store types**: Internal Zustand state shapes specific to each store

<claude-mem-context>
# Recent Activity

<!-- This section is auto-generated by claude-mem. Edit content outside the tags. -->

*No recent activity*
</claude-mem-context>